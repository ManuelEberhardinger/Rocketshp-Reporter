<h1><%= @company.name %></h1>
<% if notice %>
<div class="alert alert-info">
  <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
  <p><%= notice %></p>
</div>
<% end %>
<div class="row">
  <div class="col-sm-4">
    <h3>Client Information</h3>
    <p>
      <strong>Name:</strong>
      <%= @company.name %>
    </p>

    <p>
      <strong>Description:</strong>
      <%= @company.description %>
    </p>

    <p>
      <strong>Lead source:</strong>
      <%= @company.lead_source %>
    </p>

    <p>
      <strong>Job types:</strong>
      <%= @company.job_types %>
    </p>

    <p>
      <strong>Website:</strong>
      <%= link_to @company.website, @company.website, target: 'blank' %>
    </p>

    <p>
      <strong>Monthly total:</strong>
      $<%= @company.monthly_total.to_i %>
    </p>

    <p>
      <strong>Annual revenue:</strong>
      $<%= @company.monthly_total.to_i * 12 %>
    </p>

    <p>
      <strong>Address:</strong>
      <%= @company.address %>
    </p>

    <p>
      <strong>Total hours per month:</strong>
      <%= @company.total_hours %>
    </p>

    <p>
      <strong>Lost:</strong>
      <%= @company.lost %>
    </p>
    <%= link_to 'Edit Company', edit_company_path(@company) %>
    <br>
  </div>
  <div class="col-sm-8">
    <h3>Insights and Analytics</h3>
    <%= link_to 'Facebook', '/facebook' %>
    |
    <%= link_to 'Google Analytics', '/google_analytics' %>
    |
    <%= link_to 'Twitter', '/twitter' %>
    |
    <%= link_to 'LinkendIn', '/linkedin' %>
    |
    <%= link_to 'Instagram', '/instagram' %>
    <br><br>
    <h3>Contacts</h3>

    <table class="table table-striped">
      <thead>
        <tr>
          <th>First name</th>
          <th>Last name</th>
          <th>Phone</th>
          <th>Mobile</th>
          <th>Email</th>
          <th colspan="3"></th>
        </tr>
      </thead>

      <tbody>
        <% @company.contacts.each do |contact| %>
        <tr>
          <td><%= contact.first_name %></td>
          <td><%= contact.last_name %></td>
          <td><%= contact.phone %></td>
          <td><%= contact.mobile %></td>
          <td><%= contact.email %></td>
          <td><%= link_to 'Show', contact %></td>
          <td><%= link_to 'Edit', edit_contact_path(contact) %></td>
          <% if current_user.admin? %>
          <td><%= link_to 'Destroy', contact, method: :delete, data: { confirm: 'Are you sure?' } %></td>
          <% end %>
        </tr>
        <% end %>
      </tbody>
    </table>
    <%= link_to 'Add Contact', new_contact_path %>
  </div>
</div>
<div class="row">
  <div class="container-fluid">
    <h3>Time Trackings</h3>
    <h4>Total Value: <%= sum_up_total_value_of_time_trackings(@time_trackings) %>$</h4>
    <table class="table table-striped">
      <thead>
        <tr>
          <th>User</th>
          <th>Spent Time (hours)</th>
          <th>Hourly Rate</th>
          <th>Date</th>
          <th>Description</th>
          <th>Total Value</th>
          <th colspan="3"></th>
        </tr>
      </thead>

      <tbody>
        <% @time_trackings.each do |time_tracking| %>
        <tr>
          <td><%= time_tracking.user.name %></td>
          <td><%= time_tracking.spent_time %>h</td>
          <td><%= time_tracking.hourly_rate %>$</td>
          <td><%= time_tracking.date.strftime('%d/%m/%Y') %></td>
          <td><%= time_tracking.description %></td>
          <td><%= time_tracking.spent_time * time_tracking.hourly_rate %>$</td>
          <td><%= link_to 'Show', time_tracking %></td>
          <% if current_user.admin? || current_user?(time_tracking.user) %>
          <td><%= link_to('Edit', edit_time_tracking_path(time_tracking)) %></td>
          <% else %>
          <td></td>
          <% end %>
          <% if current_user.admin? %>
          <td><%= link_to('Destroy', time_tracking, method: :delete, data: { confirm: 'Are you sure?' }) %></td>
          <% elsif current_user.admin? %>
          <td></td>
          <% end %>
        </tr>
        <% end %>
      </tbody>
    </table>
    <%= link_to 'Add Time', new_time_tracking_path %>
  </div>
</div>
<div class="row">
  <% if @company.total_hours %>
  <div class="col-sm-4">
    <h3>Time</h3>
    <%= pie_chart sum_up_total_hours_to_display(@time_trackings, @company.total_hours) %>
  </div>
  <% end %>
  <% if @company.monthly_total %>
  <div class="col-sm-4">
    <h3>Income</h3>
    <%= pie_chart get_total_values_to_display(@time_trackings, @company.monthly_total) %>
  </div>
  <div class="col-sm-4">
    <% if @time_trackings.count > 0 %>
    <h3>Employees</h3>
    <%= column_chart get_spent_time_of_employees(@time_trackings) %>
    <% end %>
  </div>
  <% end %>
</div>
<br>
